C51 COMPILER V9.50a   SCR                                                                  07/17/2017 17:31:02 PAGE 1   


C51 COMPILER V9.50a, COMPILATION OF MODULE SCR
OBJECT MODULE PLACED IN SCR.OBJ
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE SCR.c LARGE OPTIMIZE(7,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*****************************************************************
   2                                       SCR.C  file
   3          
   4          主要功能：负责可控硅模块的控制及初始化
   5          
   6          创建时间：2015.10.31
   7          *****************************************************************/
   8          /*--------------------------------------------------------------*/
   9          /*---------------------------头文件-----------------------------*/
  10          /*--------------------------------------------------------------*/
  11          #include <STC89C5xRC.h>
  12          #include "SCR.h"
  13          /*--------------------------------------------------------------*/
  14          
  15          
  16          
  17          /*--------------------------------------------------------------*/
  18          /*-------------------------全局变量定义-------------------------*/
  19          /*--------------------------------------------------------------*/
  20          unsigned char SCR_counter;                           //可控硅延时计数器
  21          unsigned char SCR1_value;                            //可控硅1延时导通值,不是实际的亮度值，亮度值为100-val
             -ue
  22          unsigned char SCR2_value;                            //可控硅2延迟导通值
  23          unsigned char SCR1_timer;                            //可控硅1导通高脉冲时间计数器
  24          unsigned char SCR2_timer;                            //可控硅2导通高脉冲时间计数器
  25          
  26          bit  SCR1_Flag;                                      //可控硅口1状态改变标志位
  27          bit  SCR2_Flag;                                      //可控硅口2状态改变标志位
  28          bit  SCR1_status;                                    //可控硅口1状态标志位，标志调光的方向
  29          bit  SCR2_status;                                    //可控硅口2状态标志位，标志调光的方向
  30          bit  SCR1_control_flag;                              //可控硅口1调光标志位
  31          bit  SCR2_control_flag;                              //可控硅口2调光标志位
  32          unsigned int SCR_control_counter;                    //可控硅调光计数器
  33          
  34          bit Scr_100_Flag;                 //可控硅100%亮度状态触发标志位
  35          bit Scr_Off_Flag;                 //可控硅0%亮度状态触发标志位
  36          bit Scr_Check_Flag;                 //可控硅状态检测标志位
  37          bit Scr1_Act_Flag;                  //可控硅输出动作标志位
  38          bit Scr2_Act_Flag;
  39          /*--------------------------------------------------------------*/
  40          /*--------------------------------------------------------------*/
  41          /*-------------------------可控硅初始化------------------------*/
  42          /*--------------------------------------------------------------*/
  43          
  44          void init_scr()
  45          {
  46   1        SCR_counter=0;
  47   1        SCR1_value=0xF0;
  48   1        SCR2_value=0xF0;
  49   1        SCR1_timer=0;
  50   1        SCR2_timer=0;
  51   1        
  52   1        SCR1_Flag=0;
  53   1        SCR2_Flag=0;
  54   1        SCR1_status=0;
C51 COMPILER V9.50a   SCR                                                                  07/17/2017 17:31:02 PAGE 2   

  55   1        SCR2_status=0;
  56   1        SCR1_control_flag=0;
  57   1        SCR2_control_flag=0;
  58   1        SCR_control_counter=0;
  59   1        
  60   1        Scr_Check_Flag=1;
  61   1        
  62   1        IE1=0;                                             //开中断之前先清空一下中断标志位
  63   1        EX1=1;
  64   1        IT1=1;                                             //外部中断设置为下跳沿触发模式
  65   1      }
  66          /*--------------------------------------------------------------*/
  67          /*--------------------------------------------------------------*/
  68          /*-------------------------外部中断1程序- ----------------------*/
  69          /*             功能：过零检测电路触发中断                       */
  70          /*--------------------------------------------------------------*/
  71          void interrupt_INT1() interrupt 2                    //外部中断1的中断号为2
  72          {
  73   1        TH2=0xFF;TL2=0x0A;                                 //重新校准计数器2,防止灯光抖动
  74   1        SCR_counter=0;                                     //清零SCR计数器
  75   1        TF2=0;                                             //清空计数器2的中断标志位
  76   1      }
  77          /*--------------------------------------------------------------*/
  78          
  79          /*--------------------------------------------------------------*/
  80          /*------------------------可控硅处理程序------------------------*/
  81          /*--------------------------------------------------------------*/
  82          //void scr_handle()
  83          //{
  84            
  85          //}


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     69    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      7    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =     11    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
